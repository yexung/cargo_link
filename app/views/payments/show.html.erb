<div class="min-h-screen bg-gray-50 py-8">
  <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
    <!-- Header -->
    <div class="mb-8">
      <div class="flex items-center justify-between">
        <div>
          <h1 class="text-3xl font-bold text-gray-900">결제 안내</h1>
          <p class="mt-2 text-gray-600">낙찰된 차량의 결제를 진행해주세요.</p>
        </div>
        <div class="text-right">
          <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium 
            <% case @payment.status %>
            <% when 'pending' %>
              bg-yellow-100 text-yellow-800
            <% when 'reported' %>
              bg-blue-100 text-blue-800
            <% when 'confirmed' %>
              bg-green-100 text-green-800
            <% when 'rejected' %>
              bg-red-100 text-red-800
            <% else %>
              bg-gray-100 text-gray-800
            <% end %>">
            <% case @payment.status %>
            <% when 'pending' %>
              입금 대기
            <% when 'reported' %>
              입금 신고됨
            <% when 'confirmed' %>
              결제 완료
            <% when 'rejected' %>
              결제 거부
            <% else %>
              <%= @payment.status %>
            <% end %>
          </span>
        </div>
      </div>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
      <!-- 차량 정보 -->
      <div class="bg-white shadow rounded-lg overflow-hidden">
        <div class="px-6 py-4 border-b border-gray-200">
          <h3 class="text-lg font-semibold text-gray-900">낙찰 차량 정보</h3>
        </div>
        <div class="p-6">
          <% if @payment.vehicle.images.attached? && @payment.vehicle.images.any? %>
            <div class="mb-4">
              <%= image_tag rails_blob_path(@payment.vehicle.images.first, only_path: true), 
                  class: "w-full h-48 object-cover rounded-lg" %>
            </div>
          <% end %>
          
          <h4 class="text-xl font-semibold text-gray-900 mb-2">
            <%= @payment.vehicle.title %>
          </h4>
          
          <div class="space-y-2 text-sm text-gray-600">
            <div class="flex justify-between">
              <span>브랜드:</span>
              <span class="font-medium"><%= @payment.vehicle.brand %></span>
            </div>
            <div class="flex justify-between">
              <span>연식:</span>
              <span class="font-medium"><%= @payment.vehicle.year %>년</span>
            </div>
            <div class="flex justify-between">
              <span>주행거리:</span>
              <span class="font-medium"><%= number_with_delimiter(@payment.vehicle.mileage) %>km</span>
            </div>
            <div class="flex justify-between">
              <span>연료:</span>
              <span class="font-medium"><%= @payment.vehicle.fuel_type %></span>
            </div>
          </div>
        </div>
      </div>

      <!-- 결제 정보 -->
      <div class="bg-white shadow rounded-lg overflow-hidden">
        <div class="px-6 py-4 border-b border-gray-200">
          <h3 class="text-lg font-semibold text-gray-900">결제 정보</h3>
        </div>
        <div class="p-6">
          <div class="space-y-4">
            <div class="flex justify-between py-2">
              <span class="text-gray-600">차량 가격:</span>
              <span class="font-semibold text-lg">₩<%= number_with_delimiter(@payment.vehicle_price) %></span>
            </div>
            
            <div class="flex justify-between py-2">
              <span class="text-gray-600">플랫폼 수수료 (<%= @payment.commission_rate %>%):</span>
              <span class="font-semibold">₩<%= number_with_delimiter(@payment.commission_amount) %></span>
            </div>
            
            <div class="border-t pt-4">
              <div class="flex justify-between">
                <span class="text-lg font-semibold text-gray-900">총 결제 금액:</span>
                <span class="text-2xl font-bold text-green-600">₩<%= number_with_delimiter(@payment.total_amount) %></span>
              </div>
            </div>
          </div>

          <div class="mt-6 p-4 bg-blue-50 rounded-lg">
            <h4 class="font-semibold text-blue-900 mb-2">💡 안내사항</h4>
            <ul class="text-sm text-blue-800 space-y-1">
              <li>• 구매자가 플랫폼 수수료를 부담합니다</li>
              <li>• 판매자는 차량 가격 전액을 받습니다</li>
              <li>• 입금 후 관리자 승인까지 1-2시간 소요됩니다</li>
            </ul>
          </div>
        </div>
      </div>
    </div>

    <!-- 입금 안내 -->
    <div class="mt-8 bg-white shadow rounded-lg overflow-hidden">
      <div class="px-6 py-4 border-b border-gray-200">
        <h3 class="text-lg font-semibold text-gray-900">입금 안내</h3>
      </div>
      <div class="p-6">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div>
            <h4 class="font-semibold text-gray-900 mb-4">입금 계좌 정보</h4>
            <div class="bg-gray-50 p-4 rounded-lg space-y-2">
              <div class="flex justify-between">
                <span class="text-gray-600">은행명:</span>
                <span class="font-semibold"><%= @bank_info[:bank_name] %></span>
              </div>
              <div class="flex justify-between">
                <span class="text-gray-600">계좌번호:</span>
                <span class="font-semibold font-mono"><%= @bank_info[:account_number] %></span>
              </div>
              <div class="flex justify-between">
                <span class="text-gray-600">예금주:</span>
                <span class="font-semibold"><%= @bank_info[:account_holder] %></span>
              </div>
            </div>
          </div>

          <div>
            <h4 class="font-semibold text-gray-900 mb-4">입금 완료 신고</h4>
            <% if @payment.status == 'pending' %>
              <%= form_with model: @payment, local: true, class: "space-y-4" do |form| %>
                <div>
                  <%= form.label :bank_name, "입금 은행", class: "block text-sm font-medium text-gray-700" %>
                  <%= form.text_field :bank_name, 
                      class: "mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-green-500 focus:ring-green-500",
                      placeholder: "예: 국민은행" %>
                </div>

                <div>
                  <%= form.label :depositor_name, "입금자명", class: "block text-sm font-medium text-gray-700" %>
                  <%= form.text_field :depositor_name, 
                      class: "mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-green-500 focus:ring-green-500",
                      placeholder: "실제 입금하신 분의 이름" %>
                </div>

                <div>
                  <%= form.submit "입금 완료 신고", 
                      class: "w-full bg-green-600 text-white py-2 px-4 rounded-md hover:bg-green-700 font-medium" %>
                </div>
              <% end %>
            <% elsif @payment.status == 'reported' %>
              <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
                <div class="flex">
                  <div class="flex-shrink-0">
                    <svg class="h-5 w-5 text-yellow-400" fill="currentColor" viewBox="0 0 20 20">
                      <path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd"/>
                    </svg>
                  </div>
                  <div class="ml-3">
                    <h3 class="text-sm font-medium text-yellow-800">입금 신고 완료</h3>
                    <p class="mt-1 text-sm text-yellow-700">관리자 승인을 기다리고 있습니다.</p>
                  </div>
                </div>
              </div>
            <% elsif @payment.status == 'confirmed' %>
              <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                <div class="flex">
                  <div class="flex-shrink-0">
                    <svg class="h-5 w-5 text-green-400" fill="currentColor" viewBox="0 0 20 20">
                      <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
                    </svg>
                  </div>
                  <div class="ml-3">
                    <h3 class="text-sm font-medium text-green-800">결제 완료</h3>
                    <p class="mt-1 text-sm text-green-700">입금이 확인되었습니다. 판매자에게 정산이 진행됩니다.</p>
                  </div>
                </div>
              </div>
            <% end %>
          </div>
        </div>
      </div>
    </div>

    <!-- 하단 버튼 -->
    <div class="mt-8 flex justify-center">
      <%= link_to "구매자 대시보드로 돌아가기", buyers_dashboard_path, 
          class: "inline-flex items-center px-6 py-3 border border-gray-300 shadow-sm text-base font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50" %>
    </div>
  </div>
</div> 